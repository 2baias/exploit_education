# Source code

```C
#include <err.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#define BANNER \
  "Welcome to " LEVELNAME ", brought to you by https://exploit.education"

int main(int argc, char **argv) {
  struct {
    char dest[32];
    volatile int changeme;
  } locals;
  char buffer[16];

  printf("%s\n", BANNER);

  if (fgets(buffer, sizeof(buffer) - 1, stdin) == NULL) {
    errx(1, "Unable to get buffer");
  }
  buffer[15] = 0;

  locals.changeme = 0;

  sprintf(locals.dest, buffer);

  if (locals.changeme != 0) {
    puts("Well done, the 'changeme' variable has been changed!");
  } else {
    puts(
        "Uh oh, 'changeme' has not yet been changed. Would you like to try "
        "again?");
  }

  exit(0);
}
```

# Walkthrough

To find out what `sprintf` does, we run `man sprintf` as always. We find the
following information

> sprintf(), snprintf(), vsprintf(),  and  vsnprintf()  write  to  
the  character string str.

I want to make sure buffer contains a format that "explodes", something like
formatting 0.0 as 0.00...0 or something.

In `C`, we would do something like

```
#include<stdio.h>

int main(){
  printf("%.100f",0);
  return 0;
}
```

we don't have two arguments. I tried with `printf("%.100f")` and then it prints
a bunch of zeroes. Cool, nearly there! But we want to print something else than
zero. Hmm, maybe the `s` flag can help us?


>s      If  no  l modifier is present: the const char * argument is expected to
be a pointer to an array of character type (pointer to a string).  Characters from 
the array are written up to (but not including) a terminating null byte ('\0');
if a precision is specified, no more than the number specified are written.  If  a
precision is given, no null byte need be present; if the precision is not
specified, or is greater than the size of the array, the array must contain a
terminating null byte.

Promising! So let's try `printf("%100s")`. Cool, it prints out a bunch of garbage!

Let's try to input `%100s` to `format-zero` then. Nice, it works out immediately!
